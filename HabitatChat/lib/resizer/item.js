"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

/*
Copyright 2019 New Vector Ltd

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
class ResizeItem {
  constructor(handle, resizer, sizer) {
    const id = handle.getAttribute("data-id");
    const reverse = resizer.isReverseResizeHandle(handle);
    const domNode = reverse ? handle.nextElementSibling : handle.previousElementSibling;
    this.domNode = domNode;
    this.id = id;
    this.reverse = reverse;
    this.resizer = resizer;
    this.sizer = sizer;
  }

  _copyWith(handle, resizer, sizer) {
    const Ctor = this.constructor;
    return new Ctor(handle, resizer, sizer);
  }

  _advance(forwards) {
    // opposite direction from fromResizeHandle to get back to handle
    let handle = this.reverse ? this.domNode.previousElementSibling : this.domNode.nextElementSibling;
    const moveNext = forwards !== this.reverse; // xor
    // iterate at least once to avoid infinite loop

    do {
      if (moveNext) {
        handle = handle.nextElementSibling;
      } else {
        handle = handle.previousElementSibling;
      }
    } while (handle && !this.resizer.isResizeHandle(handle));

    if (handle) {
      const nextHandle = this._copyWith(handle, this.resizer, this.sizer);

      nextHandle.reverse = this.reverse;
      return nextHandle;
    }
  }

  next() {
    return this._advance(true);
  }

  previous() {
    return this._advance(false);
  }

  size() {
    return this.sizer.getItemSize(this.domNode);
  }

  offset() {
    return this.sizer.getItemOffset(this.domNode);
  }

  setSize(size) {
    this.sizer.setItemSize(this.domNode, size);
    const callback = this.resizer.config.onResized;

    if (callback) {
      callback(size, this.id, this.domNode);
    }
  }

  clearSize() {
    this.sizer.clearItemSize(this.domNode);
    const callback = this.resizer.config.onResized;

    if (callback) {
      callback(null, this.id, this.domNode);
    }
  }

  first() {
    const firstHandle = Array.from(this.domNode.parentElement.children).find(el => {
      return this.resizer.isResizeHandle(el);
    });

    if (firstHandle) {
      return this._copyWith(firstHandle, this.resizer, this.sizer);
    }
  }

  last() {
    const lastHandle = Array.from(this.domNode.parentElement.children).reverse().find(el => {
      return this.resizer.isResizeHandle(el);
    });

    if (lastHandle) {
      return this._copyWith(lastHandle, this.resizer, this.sizer);
    }
  }

}

exports.default = ResizeItem;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9yZXNpemVyL2l0ZW0uanMiXSwibmFtZXMiOlsiUmVzaXplSXRlbSIsImNvbnN0cnVjdG9yIiwiaGFuZGxlIiwicmVzaXplciIsInNpemVyIiwiaWQiLCJnZXRBdHRyaWJ1dGUiLCJyZXZlcnNlIiwiaXNSZXZlcnNlUmVzaXplSGFuZGxlIiwiZG9tTm9kZSIsIm5leHRFbGVtZW50U2libGluZyIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJfY29weVdpdGgiLCJDdG9yIiwiX2FkdmFuY2UiLCJmb3J3YXJkcyIsIm1vdmVOZXh0IiwiaXNSZXNpemVIYW5kbGUiLCJuZXh0SGFuZGxlIiwibmV4dCIsInByZXZpb3VzIiwic2l6ZSIsImdldEl0ZW1TaXplIiwib2Zmc2V0IiwiZ2V0SXRlbU9mZnNldCIsInNldFNpemUiLCJzZXRJdGVtU2l6ZSIsImNhbGxiYWNrIiwiY29uZmlnIiwib25SZXNpemVkIiwiY2xlYXJTaXplIiwiY2xlYXJJdGVtU2l6ZSIsImZpcnN0IiwiZmlyc3RIYW5kbGUiLCJBcnJheSIsImZyb20iLCJwYXJlbnRFbGVtZW50IiwiY2hpbGRyZW4iLCJmaW5kIiwiZWwiLCJsYXN0IiwibGFzdEhhbmRsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOzs7Ozs7Ozs7Ozs7Ozs7QUFnQmUsTUFBTUEsVUFBTixDQUFpQjtBQUM1QkMsRUFBQUEsV0FBVyxDQUFDQyxNQUFELEVBQVNDLE9BQVQsRUFBa0JDLEtBQWxCLEVBQXlCO0FBQ2hDLFVBQU1DLEVBQUUsR0FBR0gsTUFBTSxDQUFDSSxZQUFQLENBQW9CLFNBQXBCLENBQVg7QUFDQSxVQUFNQyxPQUFPLEdBQUdKLE9BQU8sQ0FBQ0sscUJBQVIsQ0FBOEJOLE1BQTlCLENBQWhCO0FBQ0EsVUFBTU8sT0FBTyxHQUFHRixPQUFPLEdBQUdMLE1BQU0sQ0FBQ1Esa0JBQVYsR0FBK0JSLE1BQU0sQ0FBQ1Msc0JBQTdEO0FBRUEsU0FBS0YsT0FBTCxHQUFlQSxPQUFmO0FBQ0EsU0FBS0os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NUIsQ0FBUDtBQUNILEtBRm1CLENBQXBCOztBQUdBLFFBQUlOLFdBQUosRUFBaUI7QUFDYixhQUFPLEtBQUtyQixTQUFMLENBQWVxQixXQUFmLEVBQTRCLEtBQUs5QixPQUFqQyxFQUEwQyxLQUFLQyxLQUEvQyxDQUFQO0FBQ0g7QUFDSjs7QUFFRG9DLEVBQUFBLElBQUksR0FBRztBQUNILFVBQU1DLFVBQVUsR0FBR1AsS0FBSyxDQUFDQyxJQUFOLENBQVcsS0FBSzFCLE9BQUwsQ0FBYTJCLGFBQWIsQ0FBMkJDLFFBQXRDLEVBQWdEOUIsT0FBaEQsR0FBMEQrQixJQUExRCxDQUErREMsRUFBRSxJQUFJO0FBQ3BGLGFBQU8sS0FBS3BDLE9BQUwsQ0FBYWMsY0FBYixDQUE0QnNCLEVBQTVCLENBQVA7QUFDSCxLQUZrQixDQUFuQjs7QUFHQSxRQUFJRSxVQUFKLEVBQWdCO0FBQ1osYUFBTyxLQUFLN0IsU0FBTCxDQUFlNkIsVUFBZixFQUEyQixLQUFLdEMsT0FBaEMsRUFBeUMsS0FBS0MsS0FBOUMsQ0FBUDtBQUNIO0FBQ0o7O0FBekYyQiIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAxOSBOZXcgVmVjdG9yIEx0ZFxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlc2l6ZUl0ZW0ge1xuICAgIGNvbnN0cnVjdG9yKGhhbmRsZSwgcmVzaXplciwgc2l6ZXIpIHtcbiAgICAgICAgY29uc3QgaWQgPSBoYW5kbGUuZ2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiKTtcbiAgICAgICAgY29uc3QgcmV2ZXJzZSA9IHJlc2l6ZXIuaXNSZXZlcnNlUmVzaXplSGFuZGxlKGhhbmRsZSk7XG4gICAgICAgIGNvbnN0IGRvbU5vZGUgPSByZXZlcnNlID8gaGFuZGxlLm5leHRFbGVtZW50U2libGluZyA6IGhhbmRsZS5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgIHRoaXMuZG9tTm9kZSA9IGRvbU5vZGU7XG4gICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgdGhpcy5yZXZlcnNlID0gcmV2ZXJzZTtcbiAgICAgICAgdGhpcy5yZXNpemVyID0gcmVzaXplcjtcbiAgICAgICAgdGhpcy5zaXplciA9IHNpemVyO1xuICAgIH1cblxuICAgIF9jb3B5V2l0aChoYW5kbGUsIHJlc2l6ZXIsIHNpemVyKSB7XG4gICAgICAgIGNvbnN0IEN0b3IgPSB0aGlzLmNvbnN0cnVjdG9yO1xuICAgICAgICByZXR1cm4gbmV3IEN0b3IoaGFuZGxlLCByZXNpemVyLCBzaXplcik7XG4gICAgfVxuXG4gICAgX2FkdmFuY2UoZm9yd2FyZHMpIHtcbiAgICAgICAgLy8gb3Bwb3NpdGUgZGlyZWN0aW9uIGZyb20gZnJvbVJlc2l6ZUhhbmRsZSB0byBnZXQgYmFjayB0byBoYW5kbGVcbiAgICAgICAgbGV0IGhhbmRsZSA9IHRoaXMucmV2ZXJzZSA/XG4gICAgICAgICAgICB0aGlzLmRvbU5vZGUucHJldmlvdXNFbGVtZW50U2libGluZyA6XG4gICAgICAgICAgICB0aGlzLmRvbU5vZGUubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgICBjb25zdCBtb3ZlTmV4dCA9IGZvcndhcmRzICE9PSB0aGlzLnJldmVyc2U7IC8vIHhvclxuICAgICAgICAvLyBpdGVyYXRlIGF0IGxlYXN0IG9uY2UgdG8gYXZvaWQgaW5maW5pdGUgbG9vcFxuICAgICAgICBkbyB7XG4gICAgICAgICAgICBpZiAobW92ZU5leHQpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGUgPSBoYW5kbGUubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBoYW5kbGUgPSBoYW5kbGUucHJldmlvdXNFbGVtZW50U2libGluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSB3aGlsZSAoaGFuZGxlICYmICF0aGlzLnJlc2l6ZXIuaXNSZXNpemVIYW5kbGUoaGFuZGxlKSk7XG5cbiAgICAgICAgaWYgKGhhbmRsZSkge1xuICAgICAgICAgICAgY29uc3QgbmV4dEhhbmRsZSA9IHRoaXMuX2NvcHlXaXRoKGhhbmRsZSwgdGhpcy5yZXNpemVyLCB0aGlzLnNpemVyKTtcbiAgICAgICAgICAgIG5leHRIYW5kbGUucmV2ZXJzZSA9IHRoaXMucmV2ZXJzZTtcbiAgICAgICAgICAgIHJldHVybiBuZXh0SGFuZGxlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FkdmFuY2UodHJ1ZSk7XG4gICAgfVxuXG4gICAgcHJldmlvdXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hZHZhbmNlKGZhbHNlKTtcbiAgICB9XG5cbiAgICBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zaXplci5nZXRJdGVtU2l6ZSh0aGlzLmRvbU5vZGUpO1xuICAgIH1cblxuICAgIG9mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZXIuZ2V0SXRlbU9mZnNldCh0aGlzLmRvbU5vZGUpO1xuICAgIH1cblxuICAgIHNldFNpemUoc2l6ZSkge1xuICAgICAgICB0aGlzLnNpemVyLnNldEl0ZW1TaXplKHRoaXMuZG9tTm9kZSwgc2l6ZSk7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrID0gdGhpcy5yZXNpemVyLmNvbmZpZy5vblJlc2l6ZWQ7XG4gICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgY2FsbGJhY2soc2l6ZSwgdGhpcy5pZCwgdGhpcy5kb21Ob2RlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNsZWFyU2l6ZSgpIHtcbiAgICAgICAgdGhpcy5zaXplci5jbGVhckl0ZW1TaXplKHRoaXMuZG9tTm9kZSk7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrID0gdGhpcy5yZXNpemVyLmNvbmZpZy5vblJlc2l6ZWQ7XG4gICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgdGhpcy5pZCwgdGhpcy5kb21Ob2RlKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgZmlyc3QoKSB7XG4gICAgICAgIGNvbnN0IGZpcnN0SGFuZGxlID0gQXJyYXkuZnJvbSh0aGlzLmRvbU5vZGUucGFyZW50RWxlbWVudC5jaGlsZHJlbikuZmluZChlbCA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXNpemVyLmlzUmVzaXplSGFuZGxlKGVsKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChmaXJzdEhhbmRsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvcHlXaXRoKGZpcnN0SGFuZGxlLCB0aGlzLnJlc2l6ZXIsIHRoaXMuc2l6ZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbGFzdCgpIHtcbiAgICAgICAgY29uc3QgbGFzdEhhbmRsZSA9IEFycmF5LmZyb20odGhpcy5kb21Ob2RlLnBhcmVudEVsZW1lbnQuY2hpbGRyZW4pLnJldmVyc2UoKS5maW5kKGVsID0+IHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlc2l6ZXIuaXNSZXNpemVIYW5kbGUoZWwpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGxhc3RIYW5kbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb3B5V2l0aChsYXN0SGFuZGxlLCB0aGlzLnJlc2l6ZXIsIHRoaXMuc2l6ZXIpO1xuICAgICAgICB9XG4gICAgfVxufVxuIl19